{
  "about": {
    "application": "Acme-Orion",
    "system": "orion",
    "environment": "PROD",
    "region": "ap-south-1",
    "owner": {
      "team": "platform-observability",
      "cost_center": "CC-OPS-1042"
    },
    "build": {
      "version": "2.17.0",
      "git": {},
      "artifacts": {
        "jar": "orion-service.jar",
        "image": "registry.acme.example/orion/orion-service:2.17.0",
        "sbom_ref": "s3://acme-orion-prod-artifacts/sbom/orion-2.17.0.spdx.json"
      }
    },
    "contacts": {
      "on_call": {
        "primary": "orion-prod-oncall",
        "secondary": "orion-platform-backup"
      },
      "slack": {
        "channel": "#orion-prod-alerts",
        "webhook_secret_ref": "secret://slack/prod/orion-alerts"
      },
      "email": {
        "dl": "orion-prod@acme.example"
      }
    }
  },

  "runtime_profile": {
    "timezone": "Asia/Kolkata",
    "locale": "en_IN",
    "start_mode": "clustered",
    "capacity": {
      "min_instances": 6,
      "max_instances": 28,
      "pod": {
        "namespace": "orion",
        "service_account": "orion-prod-sa",
        "annotations": {
          "prometheus.io/scrape": "true",
          "prometheus.io/port": "8080",
          "sidecar.istio.io/inject": "true",
          "acme.io/release-ring": "ring-prod"
        }
      }
    },
    "shutdown": {
      "grace_seconds": 60,
      "pre_stop_hooks": [
        "drain_http",
        "flush_kafka",
        "checkpoint_state",
        "close_db_pool"
      ]
    },
    "clock_policy": {
      "max_skew_seconds": 3,
      "reject_if_beyond": true
    }
  },
  "storage": {
    "postgres": {
      "primary": {
        "host": "pg-prod.acme.example",
        "port": 5432,
        "db": "orion",
        "schema": "public",
        "username": "orion_app",
        "password_ref": "secret://db/prod/orion_app_password",
        "ssl": {
          "enabled": true,
          "mode": "verify-full",
          "root_cert_path": "/etc/orion/prod/db/ca.pem"
        },
        "pool": {
          "min": 10,
          "max": 120,
          "connection_timeout_ms": 2500,
          "idle_timeout_ms": 600000,
          "max_lifetime_ms": 1800000,
          "validation_query": "SELECT 1"
        },
        "migrations": {
          "enabled": false
        }
      },
      "read_replicas": [
        {
          "name": "replica-1",
          "host": "pg-prod-ro1.acme.example",
          "port": 5432,
          "username": "orion_ro",
          "password_ref": "secret://db/prod/orion_ro_password",
          "pool": { "min": 3, "max": 30 }
        },
        {
          "name": "replica-2",
          "host": "pg-prod-ro2.acme.example",
          "port": 5432,
          "username": "orion_ro",
          "password_ref": "secret://db/prod/orion_ro_password",
          "pool": { "min": 3, "max": 30 }
        }
      ]
    },

    "redis": {
      "cache": {
        "mode": "cluster",
        "cluster_nodes": [
          "redis-c1-prod.acme.example:6379",
          "redis-c2-prod.acme.example:6379",
          "redis-c3-prod.acme.example:6379",
          "redis-c4-prod.acme.example:6379"
        ],
        "auth": { "password_ref": "secret://redis/prod/password" },
        "timeouts_ms": { "connect": 1200, "read": 1800, "write": 1800 },
        "policies": {
          "session": { "ttl_seconds": 3600, "max_entries": 400000, "eviction": "volatile-lru" },
          "feature_flags": { "ttl_seconds": 60, "max_entries": 100000, "eviction": "allkeys-lfu" },
          "lookup": { "ttl_seconds": 600, "max_entries": 800000, "eviction": "allkeys-lru" },
          "rca_context": { "ttl_seconds": 420, "max_entries": 250000, "eviction": "allkeys-lru" }
        }
      }
    },

    "object_store": {
      "artifacts": {
        "provider": "s3",
        "bucket": "acme-orion-prod-artifacts",
        "region": "ap-south-1",
        "endpoint": "https://s3.ap-south-1.amazonaws.com",
        "sse": "AES256",
        "kms_key_arn": "arn:aws:kms:ap-south-1:123456789012:key/abcd-ef01-2345-6789-abcd",
        "uploads": {
          "max_file_size_bytes": 26214400,
          "allowed_mime_types": ["application/json", "application/xml", "application/zip"]
        },
        "lifecycle": {
          "enabled": true,
          "rules": [
            { "id": "logs-archive", "prefix": "logs/", "transition_days": 14, "storage_class": "STANDARD_IA" },
            { "id": "reports-archive", "prefix": "reports/", "transition_days": 30, "storage_class": "GLACIER" }
          ]
        }
      }
    }
  },

  "messaging": {
    "kafka": {
      "enabled": true,
      "bootstrap_servers": [
        "kafka1-prod.acme.example:9093",
        "kafka2-prod.acme.example:9093",
        "kafka3-prod.acme.example:9093"
      ],
      "security": {
        "protocol": "SASL_SSL",
        "sasl_mechanism": "SCRAM-SHA-512",
        "username": "orion-prod-kafka",
        "password_ref": "secret://kafka/prod/password"
      },
      "topics": {
        "audit": {
          "name": "orion.events.audit",
          "partitions": 12,
          "replication_factor": 3,
          "retention_ms": 1209600000,
          "cleanup_policy": "delete"
        },
        "anomaly": {
          "name": "orion.events.anomaly",
          "partitions": 24,
          "replication_factor": 3,
          "retention_ms": 1209600000,
          "cleanup_policy": "delete"
        },
        "feedback": {
          "name": "orion.events.feedback",
          "partitions": 12,
          "replication_factor": 3,
          "retention_ms": 5184000000,
          "cleanup_policy": "compact,delete"
        },
        "notifications": {
          "name": "orion.events.notifications",
          "partitions": 12,
          "replication_factor": 3,
          "retention_ms": 1209600000,
          "cleanup_policy": "delete"
        },
        "dlq": {
          "name": "orion.events.dlq",
          "partitions": 6,
          "replication_factor": 3,
          "retention_ms": 1209600000,
          "cleanup_policy": "delete"
        }
      },
      "producer": {
        "acks": "all",
        "linger_ms": 5,
        "batch_size_bytes": 131072,
        "compression_type": "lz4",
        "retries": 2,
        "delivery_timeout_ms": 120000,
        "max_in_flight_requests_per_connection": 5
      },
      "consumer": {
        "group_id": "orion-prod-consumers",
        "auto_offset_reset": "latest",
        "max_poll_records": 800,
        "session_timeout_ms": 15000,
        "max_partition_fetch_bytes": 2097152,
        "concurrency": 14,
        "dead_letter": {
          "enabled": true,
          "topic": "orion.events.dlq",
          "max_attempts": 4,
          "backoff_ms": 2500
        }
      }
    },

    "scheduler": {
      "enabled": true,
      "thread_pool_size": 10,
      "jobs": [
        {
          "name": "metrics_rollup",
          "cron": "0 */5 * * * *",
          "enabled": true,
          "retry": { "max_attempts": 2, "backoff_ms": 1500 },
          "tags": ["metrics", "rollup", "prometheus"]
        },
        {
          "name": "anomaly_detect",
          "cron": "0 */2 * * * *",
          "enabled": true,
          "retry": { "max_attempts": 2, "backoff_ms": 2000 },
          "tags": ["ml", "anomaly"]
        },
        {
          "name": "cleanup_temp",
          "cron": "0 0 */12 * * *",
          "enabled": true,
          "retry": { "max_attempts": 1, "backoff_ms": 0 },
          "tags": ["maintenance"]
        },
        {
          "name": "refresh_feature_flags",
          "cron": "0 */1 * * * *",
          "enabled": true,
          "retry": { "max_attempts": 3, "backoff_ms": 500 },
          "tags": ["feature_flags", "redis"]
        },
        {
          "name": "reconcile_baselines",
          "cron": "0 */20 * * * *",
          "enabled": true,
          "retry": { "max_attempts": 2, "backoff_ms": 3500 },
          "tags": ["drift", "baseline", "git"]
        }
      ]
    }
  },

  "integrations": {
    "grafana": {
      "base_url": "https://grafana.acme.example",
      "api_path": "/api",
      "auth": { "type": "api-key", "api_key_ref": "secret://grafana/prod/api_key" }
    },
    "prometheus": {
      "base_url": "https://prometheus.acme.example",
      "paths": { "query": "/api/v1/query", "query_range": "/api/v1/query_range" },
      "auth": { "type": "basic", "username": "orion", "password_ref": "secret://prom/prod/basic_password" }
    },
    "loki": {
      "base_url": "https://loki.acme.example",
      "paths": { "query": "/loki/api/v1/query", "query_range": "/loki/api/v1/query_range" },
      "auth": { "type": "basic", "username": "orion", "password_ref": "secret://loki/prod/basic_password" }
    },
    "appdynamics": {
      "enabled": true,
      "controller_url": "https://appd.acme.example/controller",
      "account": "acme",
      "app_name": "Orion",
      "tier_name": "orion-service",
      "access_key_ref": "secret://appd/prod/access_key"
    },
    "splunk": {
      "enabled": true,
      "hec_url": "https://splunk-hec.acme.example:8088/services/collector",
      "token_ref": "secret://splunk/prod/hec_token",
      "index": "orion_prod",
      "source": "orion-service",
      "sourcetype": "orion:json",
      "batch": { "max_events": 2500, "flush_interval_ms": 2000 }
    },
    "github": {
      "enabled": true,
      "provider": "github-enterprise",
      "api_url": "https://github.acme.example/api/v3",
      "org": "acme",
      "repo": "orion-config-baselines",
      "auth": { "type": "app", "app_id": "22119", "private_key_ref": "secret://git/prod/app_private_key" }
    },
    "servicenow": {
      "enabled": true,
      "instance_url": "https://acme.service-now.com",
      "client_id": "orion-prod-sn",
      "client_secret_ref": "secret://sn/prod/client_secret",
      "cmdb": { "table": "cmdb_ci_service", "service_name": "Orion" }
    }
  },

  "observability": {
    "logging": {
      "level": "info",
      "format": "json",
      "include_mdc": true,
      "mask_secrets": true,
      "appenders": {
        "console": { "enabled": true },
        "file": {
          "enabled": true,
          "path": "/var/log/orion/prod/orion-app.log",
          "rolling": { "max_file_size_mb": 200, "max_history_days": 30, "total_size_cap_gb": 10 }
        }
      },
      "loggers": {
        "org.hibernate.SQL": "WARN",
        "com.acme.orion.security": "INFO",
        "com.acme.orion.rca": "INFO",
        "com.acme.orion.drift": "INFO",
        "com.acme.orion.integrations": "INFO",
        "com.acme.orion.scheduler": "INFO",
        "com.acme.orion.kafka": "INFO"
      }
    },
    "metrics": {
      "prometheus": {
        "enabled": true,
        "path": "/metrics",
        "include_jvm": true,
        "include_http": true,
        "include_db": true,
        "histograms": {
          "http_server_requests": {
            "enabled": true,
            "sla_buckets_ms": [50, 100, 250, 500, 1000, 2500]
          }
        }
      }
    },
    "tracing": {
      "enabled": true,
      "provider": "otlp",
      "sampling": { "strategy": "ratio", "ratio": 0.10 },
      "otlp": {
        "endpoint": "https://otel-collector.acme.example:4317",
        "headers": { "x-otlp-token": { "value_ref": "secret://otel/prod/token" } },
        "tls": { "verify": true }
      }
    },
    "alerts": {
      "enabled": true,
      "rules": [
        {
          "id": "PROD-CPU-HIGH",
          "severity": "warning",
          "condition": "cpu_active_pct > 75 for 10m",
          "notify": ["slack", "email"],
          "labels": { "env": "prod", "domain": "system" }
        },
        {
          "id": "PROD-ERROR-RATE",
          "severity": "critical",
          "condition": "http_5xx_rate > 2 for 3m",
          "notify": ["slack"],
          "labels": { "env": "prod", "domain": "http" }
        },
        {
          "id": "PROD-QUEUE-LAG",
          "severity": "critical",
          "condition": "kafka_consumer_lag > 50000 for 10m",
          "notify": ["slack"],
          "labels": { "env": "prod", "domain": "messaging" }
        }
      ]
    }
  },

  "features": {
    "source": "redis",
    "refresh_seconds": 30,
    "flags": {
      "ui.newDashboard": true,
      "ui.betaTheme": false,
      "ui.experimentalCards": false,
      "drift.semanticCompare": true,
      "drift.ignoreWhitespace": true,
      "drift.ignoreOrder": true,
      "drift.strictSchema": true,
      "rca.useRagPipeline": true,
      "rca.attachLogs": true,
      "rca.attachMetrics": true,
      "rca.maxContextTokens": 6000,
      "feedback.capture": true,
      "feedback.publicSharing": false,
      "integrations.appdynamics": true,
      "integrations.splunk": true,
      "integrations.github": true,
      "integrations.servicenow": true,
      "experiments.isolationForest": false,
      "experiments.thresholdFallback": true,
      "experiments.semanticScores": true,
      "experiments.llmDiffExplainer": true,
      "experiments.autoRemediation": false
    }
  },

  "drift": {
    "baseline": {
      "strategy": "git-signed-tag",
      "tag_prefix": "baseline/prod",
      "allow_hotfix_overrides": false,
      "require_signature": true,
      "cache_ttl_seconds": 180,
      "git": {
        "provider": "github-enterprise",
        "repo": "acme/orion-config-baselines",
        "ref_type": "tag",
        "auth": { "type": "app", "app_id": "22119", "private_key_ref": "secret://git/prod/app_private_key" }
      }
    },
    "comparison": {
      "supported_types": {
        "xml": {
          "normalize": {
            "strip_comments": true,
            "trim_whitespace": true,
            "collapse_runs": true,
            "canonicalize_empty_elements": true
          },
          "semantic_rules": {
            "ignore_attribute_order": true,
            "ignore_namespace_prefixes": true,
            "treat_missing_optional_as_default": true,
            "ignore_node_paths": [
              "/appConfig/meta/app/build/gitCommit",
              "/appConfig/meta/app/build/buildDate"
            ]
          }
        },
        "json": {
          "normalize": { "sort_keys": true, "drop_nulls": true, "coerce_numbers": true },
          "semantic_rules": {
            "ignore_array_order": false,
            "ignore_paths": [
              "$.about.build.git.commit",
              "$.about.build.git.build_date"
            ]
          }
        },
        "yaml": {
          "normalize": { "resolve_anchors": true, "coerce_booleans": true, "sort_keys": false },
          "semantic_rules": {
            "ignore_paths": [
              "about.build.*",
              "runtime_profile.capacity.pod.annotations.*"
            ]
          }
        }
      },
      "severity_matrix": {
        "security": {
          "critical": [
            "security.authentication.mode changed",
            "entrypoints.http.tls.enabled changed",
            "security.authorization.ip_allowlist.enabled=false",
            "entrypoints.http.tls.client_auth!=required"
          ],
          "high": [
            "security.authorization.ip_allowlist.allowed_cidrs expanded",
            "security.secrets.provider changed"
          ],
          "medium": ["observability.logging.mask_secrets changed"]
        },
        "performance": {
          "critical": [
            "entrypoints.http.limits.max_connections decreased > 50%",
            "entrypoints.http.limits.timeouts_ms.request increased > 2x"
          ],
          "high": [
            "storage.postgres.primary.pool.max changed",
            "messaging.kafka.consumer.concurrency changed"
          ],
          "medium": ["storage.redis.cache.policies.*.ttl_seconds changed"]
        },
        "functional": {
          "critical": [
            "integrations.*.base_url changed",
            "features.flags.rca.useRagPipeline toggled"
          ],
          "high": [
            "messaging.kafka.topics.*.partitions changed",
            "messaging.scheduler.jobs[].cron changed"
          ],
          "medium": ["features.flags.ui.betaTheme changed"]
        }
      }
    },
    "reporting": {
      "format": "html",
      "include_diff_snippets": true,
      "snippet_context_lines": 4,
      "include_risk_rationale": true,
      "include_suggested_remediation": true,
      "include_owner_hints": true,
      "max_findings_per_file": 2000,
      "html": {
        "embed_assets": true,
        "collapse_sections_by_default": true,
        "highlight_levels": ["critical", "high", "medium", "low"]
      }
    }
  },

  "limits": {
    "rate_limiting": {
      "enabled": true,
      "mode": "token-bucket",
      "storage": "redis",
      "global": {
        "rpm": 3500,
        "burst": 700,
        "per_ip": { "enabled": true, "rpm": 240, "burst": 60 },
        "per_user": { "enabled": true, "rpm": 420, "burst": 100 }
      },
      "routes": {
        "/orion/api/v1/drift/compare": { "rpm": 180, "burst": 40 },
        "/orion/api/v1/rca/analyze": { "rpm": 120, "burst": 25 },
        "/orion/api/v1/feedback": { "rpm": 300, "burst": 60 },
        "/orion/api/v1/admin/*": { "rpm": 60, "burst": 15, "requires_role": "admin" }
      }
    },
    "payload_limits": {
      "max_config_file_bytes": 8388608,
      "max_total_upload_bytes": 26214400,
      "max_feedback_bytes": 65536,
      "max_log_snippet_bytes": 262144
    }
  },

  "ai": {
    "provider": "external-api",
    "routing": {
      "default_model": "sonar-medium",
      "routes": [
        { "task": "rca.summary", "model": "sonar-medium", "max_tokens": 800, "temperature": 0.25 },
        { "task": "rca.deep", "model": "sonar-large", "max_tokens": 1200, "temperature": 0.2 },
        { "task": "diff.explain", "model": "sonar-medium", "max_tokens": 700, "temperature": 0.15 },
        { "task": "remediation.plan", "model": "sonar-large", "max_tokens": 1000, "temperature": 0.3 }
      ]
    },
    "api": {
      "base_url": "https://llm.acme.example/v1",
      "timeout_ms": 22000,
      "api_key_ref": "secret://llm/prod/api_key",
      "max_concurrent_requests": 12,
      "backpressure": { "queue_size": 300, "reject_when_full": true },
      "retry": { "max": 2, "backoff_ms": 900 }
    },
    "guardrails": {
      "pii_detection": { "enabled": true, "action": "redact" },
      "secrets_detection": { "enabled": true, "action": "block" },
      "allowed_data_classes": ["metrics", "logs", "config", "topology"],
      "blocked_terms": ["card_number", "cvv", "aadhar", "pan", "otp"]
    }
  },

  "ui": {
    "branding": {
      "title": "Orion",
      "logo_path": "/static/prod/orion-logo.svg",
      "theme": "dark",
      "accent_color": "#00C853"
    },
    "navigation": {
      "menu": [
        { "key": "dashboard", "label": "Dashboards", "path": "/ui/dashboards" },
        { "key": "drift", "label": "Config Drift", "path": "/ui/drift" },
        { "key": "anomalies", "label": "Anomalies", "path": "/ui/anomalies" },
        { "key": "rca", "label": "RCA Reports", "path": "/ui/rca" },
        { "key": "feedback", "label": "Feedback", "path": "/ui/feedback" },
        { "key": "admin", "label": "Admin", "path": "/ui/admin", "requires_role": "admin" }
      ]
    },
    "ux": {
      "collapse_advanced_by_default": true,
      "show_beta_badges": false,
      "enable_live_refresh": true,
      "live_refresh_seconds": 30,
      "toast_duration_ms": 4000
    }
  }
}
