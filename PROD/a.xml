<?xml version="1.0" encoding="UTF-8"?>
<environment name="PROD" schema="v2">
  <meta>
    <region>eu-west-1</region>
    <owner>ops-prod</owner>
    <created>2024-06-01</created>
    <changeWindow>sun-02:00-04:00</changeWindow>
  </meta>
  <network>
    <cidr>10.10.0.0/16</cidr>
    <dns enabled="1"/>
    <nat mode="enabled"/>
    <subnets>
      <public>
        <item id="subnet-prod-pub-a" az="a"/>
        <item id="subnet-prod-pub-b" az="b"/>
      </public>
      <private>
        <item id="subnet-prod-priv-a" az="a"/>
        <item id="subnet-prod-priv-b" az="b"/>
      </private>
    </subnets>
    <egress>
      <allowedPorts>443,53</allowedPorts>
    </egress>
  </network>
  <service name="drift-api">
    <https port="8443" basePath="/"/>
    <timeouts>
      <connectMs>3s</connectMs>
      <readMs>0.5m</readMs>
      <retry>
        <maxAttempts>3</maxAttempts>
        <backoffMs>250</backoffMs>
      </retry>
    </timeouts>
    <limits>
      <rate rps="200"/>
      <payload maxMb="20"/>
    </limits>
  </service>
  <database engine="aurora-postgresql">
    <endpoint host="prod-db.cluster.internal" port="5432"/>
    <pool min="10" max="80"/>
    <backup retentionDays="7" pitr="true"/>
  </database>
  <security>
    <tls min="1.3"/>
    <waf enabled="true"/>
    <auth mode="oidc">
      <issuer>prod-idp</issuer>
      <tokenTtl seconds="600"/>
    </auth>
  </security>
  <!-- whole block removed: observability/logs moved to sidecar in PROD -->
</environment>
